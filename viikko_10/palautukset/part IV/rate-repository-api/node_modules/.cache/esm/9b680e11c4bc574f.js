let gql,yup,Review;_c4b‍.x([["typeDefs",()=>typeDefs],["resolvers",()=>resolvers],["default",()=>_c4b‍.o]]);_c4b‍.w("apollo-server",[["gql",["gql"],function(v){gql=v}]]);_c4b‍.w("yup",[["*",null,function(v){yup=v}]]);_c4b‍.w("../../models/Review",[["default",["Review"],function(v){Review=v}]]);




       const typeDefs = gql`
  type User {
    id: ID!
    username: String!
    createdAt: DateTime!
    reviews(first: Int, after: String): ReviewConnection!
    reviewCount: Int!
  }
`;

const argsSchema = yup.object({
  after: yup.string(),
  first: yup
    .number()
    .min(1)
    .max(30)
    .default(30),
});

       const resolvers = {
  User: {
    reviews: async ({ id }, args) => {
      const { first, after } = await argsSchema.validate(args);

      return Review.query()
        .where({
          userId: id,
        })
        .cursorPaginate({
          orderBy: [{ column: 'createdAt', order: 'desc' }, 'id'],
          first,
          after,
        });
    },
    reviewCount: async (
      { id },
      args,
      { dataLoaders: { userReviewCountLoader } },
    ) => userReviewCountLoader.load(id),
  },
};

_c4b‍.d({
  typeDefs,
  resolvers,
});
